$(function(){Pyro.filter={$content:$("#filter-stage"),$filter_form:$("#filters form"),f_module:$('input[name="f_module"]').val(),init:function(){$("a.cancel").button();$("select",Pyro.filter.$filter_form).on("change",function(){form_data=Pyro.filter.$filter_form.serialize();Pyro.filter.do_filter(Pyro.filter.f_module,form_data)});$('input[type="text"]',Pyro.filter.$filter_form).on("keyup",function(){form_data=Pyro.filter.$filter_form.serialize();Pyro.filter.do_filter(Pyro.filter.f_module,form_data)});$("body").on("click",".pagination a",function(e){e.preventDefault();url=$(this).attr("href");form_data=Pyro.filter.$filter_form.serialize();Pyro.filter.do_filter(Pyro.filter.f_module,form_data,url)});$("a.cancel",Pyro.filter.$filter_form).click(function(){$("select",Pyro.filter.$filter_form).val("0");$('input[type="text"]').val("");form_data=Pyro.filter.$filter_form.serialize();Pyro.filter.do_filter(Pyro.filter.f_module,form_data)});Pyro.filter.$filter_form.submit(function(e){e.preventDefault()});Pyro.filter.$filter_form.find("select").first().trigger("change")},do_filter:function(e,t,n){form_action=Pyro.filter.$filter_form.attr("action");post_url=form_action?form_action:SITE_URL+"admin/"+e;typeof n!="undefined"&&(post_url=n);Pyro.clear_notifications();Pyro.filter.$content.fadeOut("fast",function(){$.post(post_url,t,function(e,t,n){var r=n.getResponseHeader("content-type")||"",i="";if(r.indexOf("application/json")>-1&&typeof e=="object"){i="html"in e?e.html:"";Pyro.filter.handler_response_json(e)}else i=e;Pyro.chosen();Pyro.filter.$content.html(i).fadeIn("fast")})})},handler_response_json:function(e){"update_filter_field"in e&&typeof e.update_filter_field=="object"&&$.each(e.update_filter_field,Pyro.filter.update_filter_field)},update_filter_field:function(e,t){var n=Pyro.filter.$filter_form.find("[name="+e+"]");if(n.is("select")&&typeof t=="object"&&"options"in t){var r,i;r=n.val();n.children("option").remove();for(i in t.options)n.append('<option value="'+i+'"'+(i==r?' selected="selected"':"")+">"+t.options[i]+"</option>")}}};Pyro.filter.init()});